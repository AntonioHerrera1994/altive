---
import '../styles/departamentos.css'

import Cerritos1 from '../assets/propiedades/cerritos/cerritos1.jpeg'
import Cerritos2 from '../assets/propiedades/cerritos/cerritos2.jpeg'
import Cerritos3 from '../assets/propiedades/cerritos/cerritos3.jpeg'
import Cerritos4 from '../assets/propiedades/cerritos/cerritos4.jpeg'
import Cerritos5 from '../assets/propiedades/cerritos/cerritos5.jpeg'
import Cerritos6 from '../assets/propiedades/cerritos/cerritos6.jpeg'
import Cerritos7 from '../assets/propiedades/cerritos/cerritos7.jpeg'

import Azaleas1 from '../assets/propiedades/azaleas/01azaleas.webp'
import Azaleas2 from '../assets/propiedades/azaleas/02azaleas.webp'
import Azaleas3 from '../assets/propiedades/azaleas/03azaleas.webp'
import Azaleas4 from '../assets/propiedades/azaleas/04azaleas.webp'
import Azaleas5 from '../assets/propiedades/azaleas/05azaleas.webp'
import Azaleas6 from '../assets/propiedades/azaleas/06azaleas.webp'

import Cha1 from '../assets/propiedades/hacienda-agua/01cha.webp'
import Cha2 from '../assets/propiedades/hacienda-agua/02cha.webp'
import Cha3 from '../assets/propiedades/hacienda-agua/03cha.webp'
import Cha4 from '../assets/propiedades/hacienda-agua/04cha.webp'
import Cha5 from '../assets/propiedades/hacienda-agua/05cha.webp'
import Cha6 from '../assets/propiedades/hacienda-agua/06cha.webp'

import Chip1 from '../assets/propiedades/chipodromo/01casahip.webp'
import Chip2 from '../assets/propiedades/chipodromo/02casahip.webp'
import Chip3 from '../assets/propiedades/chipodromo/03casahip.webp'
import Chip4 from '../assets/propiedades/chipodromo/04casahip.webp'
import Chip5 from '../assets/propiedades/chipodromo/05casahip.webp'
import Chip6 from '../assets/propiedades/chipodromo/06casahip.webp'

import Clv1 from '../assets/propiedades/lomas-villa/01casalv.webp'
import Clv2 from '../assets/propiedades/lomas-villa/02casalv.webp'
import Clv3 from '../assets/propiedades/lomas-villa/03casalv.webp'
import Clv4 from '../assets/propiedades/lomas-villa/04casalv.webp'
import Clv5 from '../assets/propiedades/lomas-villa/05casalv.webp'
import Clv6 from '../assets/propiedades/lomas-villa/06casalv.webp'

import Madred1 from '../assets/propiedades/madeiras-red/01madred.webp'
import Madred2 from '../assets/propiedades/madeiras-red/02madred.webp'
import Madred3 from '../assets/propiedades/madeiras-red/03madred.webp'
import Madred4 from '../assets/propiedades/madeiras-red/04madred.webp'
import Madred5 from '../assets/propiedades/madeiras-red/05madred.webp'
import Madred6 from '../assets/propiedades/madeiras-red/06madred.webp'

const properties = [
     {
        id: 1,
        images: [
            Cerritos1.src,
            Cerritos2.src,
            Cerritos3.src,
            Cerritos4.src,
           Cerritos5.src,
           Cerritos6.src,
           Cerritos7.src,
   
        ],
        status: 'Venta',
        statusColor: 'gold',
        beds: 3,
        baths: 3,
        sqft: '175.17 mt2s',
        title: 'Casa Cerritos, Lomas',
        price: '$8,400,00 MXN',
        description: 'Casa en Venta con Vista Panor치mica a la Ciudad. Vive en una de las zonas m치s cotizadas de la ciudad, con una vista espectacular y espacios dise침ados para disfrutar cada momento.',
        features: [
            '3 rec치maras',
            '3.5 ba침os',
            'Sala con balc칩n y vista a la ciudad',
            'Comedor con acceso a patio interior',
            'Cocina reci칠n remodelada y equipada con estufa y regfrigerador incluidos ',
            'Sala de TV con salida al patio trasero',
            'Sal칩n de juegos',
            'Bodega',
            'Cuarto de lavado con ba침o completo',
            'Cuarto de servicio',
            'Cochera techada para 2 autos',
            'Minisplits en todas las 치reas',
            '10 paneles solares',
            'C치maras de vigilancia',
            'Cisterna de 8000 lts',
             'Sistema de insolaci칩n',
        ],
        location: {
            address: 'Calle Cerritos 11723, Lomas, 22034, Tijuana, B.C.',
            lat: 32.5250,
            lng: -117.0330,
            mapEmbed: 'https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3606.089565606656!2d-116.99987762434878!3d32.496772973781994!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x80d937e353b7d87f%3A0x54601e852ce781dc!2sCerritos%2011723%2C%20Lomas%2C%2022034%20Tijuana%2C%20B.C.!5e1!3m2!1ses-419!2smx!4v1768528537452!5m2!1ses-419!2smx" width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade'
        },
        showButton: false
    },
    {
        id: 2,
        images: [
            Azaleas1.src,
            Azaleas2.src,
            Azaleas3.src,
            Azaleas4.src,
            Azaleas5.src,
            Azaleas6.src
        ],
        status: 'Venta',
        statusColor: 'gold',
        beds: 2,
        baths: 2,
        sqft: '134 mts2',
        title: 'Casa Azaleas',
        price: '$365,500 Dlls',
        description: 'Esta linda propiedad consta de cocina, elaborada toda en madera y cubierta de cuarzo, medio ba침o, amplio espacio para sala y comedor con salida a un acogedor patio interior que permite la ventilaci칩n e iluminaci칩n natural. En planta alta podemos encontra tres habitaciones, la principal con walk in closet y ba침o propio, las dos habitaciones secundarias, cada una con su closet comparten un ba침o completo. El rooftop, cuenta con una p칠rgola ya instalada e instalaci칩n para asador y medio ba침o para recibir a amigos y familiares. La casa cuenta con cochera para dos autos, equipada con tanque de gas estacionario, cisterna de 5000 lts y boiler. Se encuentra ubicada dentro de una privada de 10 casas y esta lista para habitar.',
        features: [
            'Cocina',
            'Sala',
            'Comedor',
            'Medio Ba침o',
            'Patio Interior',
            'Cochera para dos autos',
            '3 habitaciones (la principal con walk in closet y ba침o)',
            '2 ba침os completos',
            'Pergola',
            'Tanque estacionario',
            'Cisterna de 5,000 lts',
            'Instalaci칩n para ba침o en rooftop',
            'Cocina y closets de madera',
            'Cubierta de cuarzo',
            'Canceler칤a en ba침os',
            'Acabados delujo',
            'Instalaci칩n para Mini Splits'
        
        ],
        location: {
            address: 'Calle D치til #14781, Fraccionamiento Ls Arboles, 22117 Tijuana, B.C.',
            lat: 32.5250,
            lng: -117.0330,
            mapEmbed: 'https://www.google.com/maps/embed?pb=!1m17!1m12!1m3!1d3365.2051938629247!2d-116.9628333!3d32.4939444!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m2!1m1!2zMzLCsDI5JzM4LjIiTiAxMTbCsDU3JzQ2LjIiVw!5e0!3m2!1ses-419!2smx!4v1762811119770!5m2!1ses-419!2smx" width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade'
        },
        showButton: false
    },
   {
        id: 3,
        images: [
            Cha1.src,
            Cha2.src,
            Cha3.src,
            Cha4.src,
            Cha5.src,
            Cha6.src
        ],
        status: 'Venta',
        statusColor: 'gold',
        beds: 3,
        baths: 3,
        sqft: '400 mts2',
        title: 'Casa Hacienda Agua Caliente',
        price: '$14,000,000 MXN',
        description: 'La casa cuenta con 3 rec치maras, cada una con su ba침o y la principal con walk in closet y ampliaci칩n. Planta baja, sala, cocina, comedor, cuarto de lavado con 치rea de almacenamiento cochera para dos autos con port칩n el칠ctrico. Patio posterior con terraza en planta baja y gimnasio con sauna y ba침o en planta alta. Cuenta con un sistema de 12 paneles solares ya instalados, sistema de voz y datos, calefacci칩n, AC central y cisterna de 5,000 lts. La casa se entrega en obra blanca, en el precio se incluyen algunos materiales para terminarla, cabe mencionar que son de excelente calidad. Ubicada sobre sobre calle Saturno, Hacienda Agua Caliente, Segunda Etapa, zona de mucho crecimiento.',
        features: [
            'Recibidor',
            'Sala',
            'Comedor',
            'Cocina',
            'Medio ba침o',
            'Area de lavado',
            'Terraza con gimnasio Sauna y ba침o completo',
            'Cochera para dos autos',
            '3 habitaciones (la principal con walk in closet y ba침o)',
            'Area de estar',
            '3 ba침os completos',
            'Sistema de voz y datos',
            'Calefacci칩n y AC central',
            'Port칩n el칠ctrico',
            'Mini Split en gimnasio',
            'Cisterna con sistema de hidroneum치tico',
            'Sistema de 12 paneles solares ya instalados'
        
        ],
        location: {
            address: 'Calle Saturno 6043, Colonia Hacienda Agua Caliente, Segunta etapa, Tijuna, BC',
            lat: 32.5250,
            lng: -117.0330,
            mapEmbed: 'https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3606.30278920402!2d-117.0081021!3d32.49145409999999!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x80d9379400d5bc5b%3A0x84aa44ada7e2d88e!2sCasa%20Hacienda%20Aguacaliente!5e1!3m2!1ses-419!2smx!4v1762827255114!5m2!1ses-419!2smx" width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade'
        },
        showButton: false
    },
     {
        id: 4,
        images: [
            Chip1.src,
            Chip2.src,
            Chip3.src,
            Chip4.src,
            Chip5.src,
            Chip6.src
        ],
        status: 'Renta',
        statusColor: 'red',
        beds: 3,
        baths: 2,
        sqft: '240 mts2',
        title: 'Casa Hipodromo',
        price: '$2,400 Dlls',
        description: 'Casa en excelente ubicaci칩n, ideal para negocio o vivienda. La casa cuenta con tres habitaciones, la principal con walk in closet y ba침o completo con jacuzzi. Dos rec치maras secundarias con ba침o compartido, las habitaciones se conectan con un peque침o patio interior. Estancia, sala, cocina, y comedor. Cochera para dos autos y equipada con 2 boilers, cisterna, un mini split y portones el칠ctricos. La propiedad se encuentra ubicada en una zona con todos los servicios al alcance, escuelas, supermercados, caf칠s, restaurantes, farmacias y m치s.',
        features: [
            'Recibidor',
            'Sala',
            'Comedor',
            'Cocina',
            'Medio ba침o',
            '3 habitaciones',
            '2 ba침os completos',
            'Patio interior',
            'Cuarto de lavado/servicio con ba침o completo',
            'Cocina Integral',
            '2 Boilers',
            'Lavadero',
            'Cisterna'
        ],
        location: {
            address: 'Calle Trincheras 6, Hipodromo, 22020, Tijuana, B.C.',
            lat: 32.5250,
            lng: -117.0330,
            mapEmbed: 'https://www.google.com/maps/embed?pb=!1m17!1m12!1m3!1d3605.6808596098294!2d-117.00044699999998!3d32.506966000000006!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m2!1m1!2zMzLCsDMwJzI1LjEiTiAxMTfCsDAwJzAxLjYiVw!5e1!3m2!1ses-419!2smx!4v1762827742870!5m2!1ses-419!2smx" width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade'
        },
        showButton: false
    },
     {
        id: 5,
        images: [
            Clv6.src,
            Clv2.src,
            Clv3.src,
            Clv4.src,
            Clv5.src,
            Clv1.src
        ],
        status: 'Venta',
        statusColor: 'gold',
        beds: 3,
        baths: 2,
        sqft: '115 mts2',
        title: 'Casa Lomas de la Villa',
        price: '$4,100,000 MXN',
        description: 'Casa de 3 habitaciones, 2.5 ba침os, cocina y estacionamiento para 2 autos. Esta linda propiedad se encuentra ubicada dentro de una privada de 10 casas con acceso controlado. Cerca de escuelas, tiendas de autoservicio y plazas comerciales. Lista para habitarse. La zona cuenta con escuelas, 치reas comerciales y tiendas de auto servicio, asi mismo, cuenta con calles y avenidas pavimentadas y acceso a vialidades principales.',
        features: [
            'Cocina integral con cubierta de granito',
            '츼rea de sala y comedor',
            'Medio ba침o',
            '츼rea de lavado',
            '츼rea para almacenar',
            'Estacionamiento para dos autos',
            '3 habitaciones (la principal con walk in closet y ba침o)',
            '2 ba침os completos',
            'Puerta el칠ctrica de acceso a la privada',
        ],
        location: {
            address: 'Calle La Paz 5601, Lomas Del Pacifico, 22614, Tijuana, B.C.',
            lat: 32.5250,
            lng: -117.0330,
            mapEmbed: 'https://www.google.com/maps/embed?pb=!1m14!1m8!1m3!1d28841.887311636678!2d-117.0810527!3d32.5180596!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x80d9490023120afb%3A0x4232d1c606856a91!2sLOMAS%20DE%20LA%20VILLA!5e1!3m2!1ses-419!2smx!4v1762829364255!5m2!1ses-419!2smx" width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade'
        },
        showButton: false
    },
    {
        id: 6,
        images: [
            Madred1.src,
            Madred2.src,
            Madred3.src,
            Madred4.src,
            Madred5.src,
            Madred6.src
        ],
        status: 'Venta',
        statusColor: 'gold',
        beds: 3,
        baths: 2,
        sqft: '149 mts2',
        title: 'Casa Madeira Residencial',
        price: '$3,500,000 MXN',
        description: 'Esta linda propiedad se encuentra dentro de una privada muy segura y tranquila, habitada principalmente por una comunidad muy tranquila, en su mayor칤a extranjeros. La planta baja consta de cocina totalmente equipada, espacio de sala y comedor, un ba침o completo y 치rea de lavado con espacio suficiente para almacenaje tambien. En planta alta encontrar치s tres habitaciones muy bien iluminadas, cada una con closets elaborados con madera birch y un ba침o completo. La casa tambien cuenta con terreno excedente con preparaci칩n en barda lateral para un segundo nivel. Ademas de ser la 칰ltima casa de la manzana, se encuentra ubicada en la parte mas alta de la privada, lo cual permitir칤a, en caso de hacer una ampliacion, tener vista a la ciudad!',
        features: [
            'Cocina equipada con estufa, campana tipo horno y refrigerador.',
            'Espacio para sala y comedor',
            'Ba침o completo',
            'Area de lavado cerrada con espacio para almacenaje',
            'Estacionamiento para tres autos',
            'Ampliacion con capacidad para otro auto',
            'Tres habitaciones con closet',
            'Ba침o completo',
            'Port칩n el칠ctrico',
            'Tanque estacionario',
            'Tinaco para 1000 lts',
        ],
        location: {
            address: 'Priv. Moniz, Fracc. Madeira. Cuesta Blanca 22650, Cuesta Blanca, BC.',
            lat: 32.5250,
            lng: -117.0330,
            mapEmbed: 'https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3609.172800527752!2d-117.0275135!3d32.41978590000001!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x80d93728bfc00ba9%3A0xf5b7813eacb10c96!2sMadeira%20Residencial!5e1!3m2!1sen!2smx!4v1762830031043!5m2!1sen!2smx" width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade'
        },
        showButton: false
    },
]
---

<section class="depart" id="departamentos">
    <div class="depart-cont">
        <h2>Las mejores oportunidades del mercado inmobiliario.</h2>
    </div>

    <section class="properties-section">
        <div class="properties-container">
            <div class="properties-grid">
                {properties.map((property) => (
                    <div class="property-card" data-property-id={property.id}>
                        <div class="property-image">
                            <img src={property.images[0]} alt={property.title} />
                            <span class={`status-badge ${property.statusColor}`}>
                                {property.status}
                            </span>
                            {property.showButton && (
                                <button class="view-listing-btn">
                                    <i class="bi bi-house-door"></i>
                                    View Listing
                                </button>
                            )}
                        </div>
                        
                        <div class="property-info">
                            <div class="property-specs">
                                <span class="spec">
                                    <i class="bi bi-house"></i>
                                    {property.beds} Recamaras
                                </span>
                                <span class="spec">
                                    <i class="bi bi-droplet"></i>
                                    {property.baths} Ba침os
                                </span>
                                <span class="spec">
                                    <i class="bi bi-arrows-fullscreen"></i>
                                    {property.sqft}
                                </span>
                            </div>
                            
                            <h3 class="property-title">{property.title}</h3>
                            <p class="property-price">{property.price} </p>
                        </div>
                    </div>
                ))}
            </div>
        </div>

        <div class="btn-dep">
            <a href="/departamentos"><i class="bi bi-house-up"></i>Ver todas las propiedades</a>
        </div>
    </section>

    <!-- Modal / Popup -->
    <div class="property-modal" id="propertyModal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <!-- Bot칩n cerrar -->
            <button class="modal-close" id="modalClose">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="white" viewBox="0 0 16 16">
                    <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/>
                </svg>
            </button>

            <!-- Galer칤a de im치genes -->
            <div class="modal-gallery">
                <div class="gallery-main">
                    <img id="modalMainImg" src="" alt="Property" />
                    <span class="modal-badge" id="modalBadge">Venta</span>
                    
                    <!-- Controles de galer칤a -->
                    <button class="gallery-prev" id="galleryPrev">
                        <i class="bi bi-chevron-left"></i>
                    </button>
                    <button class="gallery-next" id="galleryNext">
                        <i class="bi bi-chevron-right"></i>
                    </button>
                </div>
                
                <!-- Miniaturas -->
                <div class="gallery-thumbnails" id="galleryThumbs">
                    <!-- Las miniaturas se generar치n din치micamente -->
                </div>
            </div>

            <!-- Tabs de navegaci칩n -->
            <div class="modal-tabs">
                <button class="tab-btn active" data-tab="overview">
                    <i class="bi bi-info-circle"></i>
                    Vista General
                </button>
                <button class="tab-btn" data-tab="features">
                    <i class="bi bi-list-check"></i>
                    Caracter칤sticas
                </button>
                <button class="tab-btn" data-tab="location">
                    <i class="bi bi-geo-alt"></i>
                    Ubicaci칩n
                </button>
            </div>

            <!-- Contenido de tabs -->
            <div class="modal-info">
                <!-- Tab: Vista General -->
                <div class="tab-content active" id="tab-overview">
                    <h2 id="modalTitle">Property Title</h2>
                    
                    <div class="modal-specs">
                        <span class="modal-spec">
                            <i class="bi bi-house"></i>
                            <span id="modalBeds">0</span> Recamaras
                        </span>
                        <span class="modal-spec">
                            <i class="bi bi-droplet"></i>
                            <span id="modalBaths">0</span> Ba침os
                        </span>
                        <span class="modal-spec">
                            <i class="bi bi-arrows-fullscreen"></i>
                            <span id="modalSqft">0</span> 
                        </span>
                    </div>

                    <div class="modal-price">
                        <span id="modalPrice">$0</span>
                    </div>

                    <div class="modal-description">
                        <h3>Descripci칩n</h3>
                        <p id="modalDescription">Property description will appear here.</p>
                    </div>
                </div>

                <!-- Tab: Caracter칤sticas -->
                <div class="tab-content" id="tab-features">
                    <h2>Caracter칤sticas Principales</h2>
                    <ul class="features-list" id="featuresList">
                        <!-- Las caracter칤sticas se generar치n din치micamente -->
                    </ul>
                </div>

                <!-- Tab: Ubicaci칩n -->
                <div class="tab-content" id="tab-location">
                    <h2>Ubicaci칩n</h2>
                    <div class="location-address">
                        <i class="bi bi-geo-alt-fill"></i>
                        <span id="locationAddress">Address</span>
                    </div>
                    <div class="location-map" id="locationMap">
                        <!-- El mapa se insertar치 din치micamente -->
                    </div>
                </div>

                <!-- Botones de acci칩n (siempre visibles) -->
         <!-- Botones de acci칩n (siempre visibles) -->
<div class="modal-actions">
    <button class="btn-contact">
        <i class="bi bi-telephone"></i>
        <a href="https://wa.link/i8vr13" style="color:white;text-decoration: none;">Contactar</a>
    </button>
    <button class="btn-whatsapp" id="btnWhatsapp">
        <i class="bi bi-whatsapp"></i>
        Compartir por WhatsApp
    </button>
    <button class="btn-share" id="btnShare">
        <i class="bi bi-share-fill"></i>
        Compartir
    </button>
</div>
            </div>
        </div>
    </div>
    <!-- Modal de imagen completa -->
<div class="image-fullscreen-modal" id="imageFullscreenModal">
    <div class="fullscreen-overlay"></div>
    <div class="fullscreen-content">
        <button class="fullscreen-close" id="fullscreenClose">
            <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="white" viewBox="0 0 16 16">
                <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/>
            </svg>
        </button>
        <img id="fullscreenImage" src="" alt="Imagen completa" />
        
        <!-- Controles de navegaci칩n -->
        <button class="fullscreen-prev" id="fullscreenPrev">
            <i class="bi bi-chevron-left"></i>
        </button>
        <button class="fullscreen-next" id="fullscreenNext">
            <i class="bi bi-chevron-right"></i>
        </button>
        
        <!-- Contador de im치genes -->
        <div class="image-counter" id="imageCounter">1 / 6</div>
    </div>
</div>
</section>
<script define:vars={{ properties }}>
    const propertyCards = document.querySelectorAll('.property-card');
    const modal = document.getElementById('propertyModal');
    const modalClose = document.getElementById('modalClose');
    const modalOverlay = document.querySelector('.modal-overlay');
    const tabBtns = document.querySelectorAll('.tab-btn');
    const tabContents = document.querySelectorAll('.tab-content');
    
    // Variables para modal de imagen completa
    const imageFullscreenModal = document.getElementById('imageFullscreenModal');
    const fullscreenImage = document.getElementById('fullscreenImage');
    const fullscreenClose = document.getElementById('fullscreenClose');
    const fullscreenOverlay = document.querySelector('.fullscreen-overlay');
    const fullscreenPrev = document.getElementById('fullscreenPrev');
    const fullscreenNext = document.getElementById('fullscreenNext');
    const imageCounter = document.getElementById('imageCounter');
    
    let currentProperty = null;
    let currentImageIndex = 0;

    // Funci칩n para cambiar tabs
    tabBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            const tabName = btn.getAttribute('data-tab');
            
            // Remover active de todos
            tabBtns.forEach(b => b.classList.remove('active'));
            tabContents.forEach(c => c.classList.remove('active'));
            
            // Agregar active al seleccionado
            btn.classList.add('active');
            document.getElementById(`tab-${tabName}`).classList.add('active');
        });
    });

    // Funci칩n para actualizar galer칤a
    function updateGallery(index) {
        if (!currentProperty) return;
        
        currentImageIndex = index;
        const mainImg = document.getElementById('modalMainImg');
        mainImg.src = currentProperty.images[index];
        
        // Actualizar miniaturas activas
        const thumbs = document.querySelectorAll('.gallery-thumb');
        thumbs.forEach((thumb, i) => {
            thumb.classList.toggle('active', i === index);
        });
    }

    // Funci칩n para abrir imagen en pantalla completa
    function openFullscreenImage(index) {
        if (!currentProperty) return;
        
        currentImageIndex = index;
        fullscreenImage.src = currentProperty.images[index];
        imageFullscreenModal.classList.add('active');
        updateImageCounter();
    }

    // Funci칩n para actualizar contador
    function updateImageCounter() {
        if (!currentProperty) return;
        imageCounter.textContent = `${currentImageIndex + 1} / ${currentProperty.images.length}`;
    }

    // Cerrar modal de imagen completa
    function closeFullscreenImage() {
        imageFullscreenModal.classList.remove('active');
    }

    // Eventos del modal de imagen completa
    fullscreenClose?.addEventListener('click', closeFullscreenImage);
    fullscreenOverlay?.addEventListener('click', closeFullscreenImage);

    // Navegaci칩n en imagen completa
    fullscreenPrev?.addEventListener('click', () => {
        if (!currentProperty) return;
        const newIndex = currentImageIndex === 0 ? 
            currentProperty.images.length - 1 : currentImageIndex - 1;
        openFullscreenImage(newIndex);
        updateGallery(newIndex);
    });

    fullscreenNext?.addEventListener('click', () => {
        if (!currentProperty) return;
        const newIndex = currentImageIndex === currentProperty.images.length - 1 ? 
            0 : currentImageIndex + 1;
        openFullscreenImage(newIndex);
        updateGallery(newIndex);
    });

    // Controles de galer칤a del modal principal
    document.getElementById('galleryPrev')?.addEventListener('click', () => {
        if (!currentProperty) return;
        const newIndex = currentImageIndex === 0 ? 
            currentProperty.images.length - 1 : currentImageIndex - 1;
        updateGallery(newIndex);
    });

    document.getElementById('galleryNext')?.addEventListener('click', () => {
        if (!currentProperty) return;
        const newIndex = currentImageIndex === currentProperty.images.length - 1 ? 
            0 : currentImageIndex + 1;
        updateGallery(newIndex);
    });

    // Funci칩n para generar enlace 칰nico de la propiedad
    function generatePropertyUrl(propertyId) {
        const baseUrl = window.location.origin + window.location.pathname;
        return `${baseUrl}#propiedad-${propertyId}`;
    }

    // Funci칩n para compartir propiedad
    async function shareProperty() {
        if (!currentProperty) return;
        
        const propertyUrl = generatePropertyUrl(currentProperty.id);
        const shareData = {
            title: currentProperty.title,
            text: `${currentProperty.title} - ${currentProperty.price}\n${currentProperty.description.substring(0, 100)}...`,
            url: propertyUrl
        };
        
        const btnShare = document.getElementById('btnShare');
        
        // Verificar si el navegador soporta Web Share API
        if (navigator.share) {
            try {
                await navigator.share(shareData);
                console.log('Contenido compartido exitosamente');
            } catch (err) {
                // Si el usuario cancela, no hacer nada
                if (err.name !== 'AbortError') {
                    console.log('Error al compartir:', err);
                    // Fallback: copiar al portapapeles
                    copyToClipboard(propertyUrl, btnShare);
                }
            }
        } else {
            // Fallback: copiar al portapapeles
            copyToClipboard(propertyUrl, btnShare);
        }
    }

    // Funci칩n para copiar al portapapeles
    async function copyToClipboard(text, button) {
        try {
            await navigator.clipboard.writeText(text);
            
            // Feedback visual
            const originalHTML = button.innerHTML;
            button.innerHTML = '<i class="bi bi-check-circle-fill"></i> 춰Enlace copiado!';
            button.classList.add('copied');
            
            setTimeout(() => {
                button.innerHTML = originalHTML;
                button.classList.remove('copied');
            }, 2000);
        } catch (err) {
            console.error('Error al copiar:', err);
            // M칠todo alternativo para navegadores antiguos
            fallbackCopyTextToClipboard(text, button);
        }
    }

    // M칠todo alternativo para copiar (para navegadores antiguos)
    function fallbackCopyTextToClipboard(text, button) {
        const textArea = document.createElement("textarea");
        textArea.value = text;
        textArea.style.position = "fixed";
        textArea.style.left = "-999999px";
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();
        
        try {
            const successful = document.execCommand('copy');
            if (successful) {
                const originalHTML = button.innerHTML;
                button.innerHTML = '<i class="bi bi-check-circle-fill"></i> 춰Enlace copiado!';
                button.classList.add('copied');
                
                setTimeout(() => {
                    button.innerHTML = originalHTML;
                    button.classList.remove('copied');
                }, 2000);
            }
        } catch (err) {
            console.error('Error al copiar:', err);
        }
        
        document.body.removeChild(textArea);
    }

    // Funci칩n para abrir propiedad desde URL (si viene con hash)
    function openPropertyFromUrl() {
        const hash = window.location.hash;
        if (hash.startsWith('#propiedad-')) {
            const propertyId = parseInt(hash.replace('#propiedad-', ''));
            const propertyCard = document.querySelector(`[data-property-id="${propertyId}"]`);
            if (propertyCard) {
                // Peque침o delay para asegurar que todo est칠 cargado
                setTimeout(() => {
                    propertyCard.click();
                }, 100);
            }
        }
    }

    // Ejecutar al cargar la p치gina
    window.addEventListener('load', openPropertyFromUrl);

    // Escuchar cambios en el hash
    window.addEventListener('hashchange', openPropertyFromUrl);

    // Abrir modal al hacer clic en una propiedad
    propertyCards.forEach(card => {
        card.addEventListener('click', () => {
            const propertyId = parseInt(card.getAttribute('data-property-id'));
            const property = properties.find(p => p.id === propertyId);
            
            if (property) {
                currentProperty = property;
                currentImageIndex = 0;
                
                // Informaci칩n b치sica
                document.getElementById('modalTitle').textContent = property.title;
                document.getElementById('modalBeds').textContent = property.beds;
                document.getElementById('modalBaths').textContent = property.baths;
                document.getElementById('modalSqft').textContent = property.sqft;
                document.getElementById('modalPrice').textContent = property.price;
                document.getElementById('modalDescription').textContent = property.description;
                
                const badge = document.getElementById('modalBadge');
                badge.textContent = property.status;
                badge.className = 'modal-badge ' + property.statusColor;
                
                // Galer칤a de im치genes
                const mainImg = document.getElementById('modalMainImg');
                mainImg.src = property.images[0];
                
                // IMPORTANTE: Agregar evento click a la imagen principal
                mainImg.style.cursor = 'pointer';
                mainImg.onclick = () => openFullscreenImage(currentImageIndex);
                
                const thumbsContainer = document.getElementById('galleryThumbs');
                thumbsContainer.innerHTML = '';
                
                property.images.forEach((img, index) => {
                    const thumb = document.createElement('div');
                    thumb.className = `gallery-thumb ${index === 0 ? 'active' : ''}`;
                    thumb.innerHTML = `<img src="${img}" alt="Thumb ${index + 1}">`;
                    thumb.addEventListener('click', () => updateGallery(index));
                    thumbsContainer.appendChild(thumb);
                });
                
                // Caracter칤sticas
                const featuresList = document.getElementById('featuresList');
                featuresList.innerHTML = '';
                property.features.forEach(feature => {
                    const li = document.createElement('li');
                    li.innerHTML = `
                        <i class="bi bi-check-circle-fill"></i>
                        <span>${feature}</span>
                    `;
                    featuresList.appendChild(li);
                });
                
                // Ubicaci칩n
                document.getElementById('locationAddress').textContent = property.location.address;
                const mapContainer = document.getElementById('locationMap');
                mapContainer.innerHTML = `
                    <iframe 
                        src="${property.location.mapEmbed}" 
                        width="100%" 
                        height="400" 
                        style="border:0;" 
                        allowfullscreen="" 
                        loading="lazy" 
                        referrerpolicy="no-referrer-when-downgrade">
                    </iframe>
                `;
                
                // Resetear a la primera tab
                tabBtns.forEach(b => b.classList.remove('active'));
                tabContents.forEach(c => c.classList.remove('active'));
                tabBtns[0].classList.add('active');
                tabContents[0].classList.add('active');
                
                // Actualizar URL con el hash de la propiedad
                history.replaceState(null, '', `#propiedad-${property.id}`);
                
                // Mostrar modal
                modal.classList.add('active');
                document.body.style.overflow = 'hidden';
                
             // Agregar evento al bot칩n de WhatsApp
const btnWhatsapp = document.getElementById('btnWhatsapp');
if (btnWhatsapp) {
    const newBtnWhatsapp = btnWhatsapp.cloneNode(true);
    btnWhatsapp.parentNode.replaceChild(newBtnWhatsapp, btnWhatsapp);
    newBtnWhatsapp.addEventListener('click', shareViaWhatsApp);
}

// Agregar evento al bot칩n compartir general
const btnShare = document.getElementById('btnShare');
if (btnShare) {
    const newBtnShare = btnShare.cloneNode(true);
    btnShare.parentNode.replaceChild(newBtnShare, btnShare);
    newBtnShare.addEventListener('click', shareProperty);
}
            }
        });
    });

    // Cerrar modal principal
    function closeModal() {
        modal.classList.remove('active');
        document.body.style.overflow = '';
        currentProperty = null;
        // Limpiar el hash de la URL
        history.replaceState(null, '', window.location.pathname);
    }

    modalClose?.addEventListener('click', closeModal);
    modalOverlay?.addEventListener('click', closeModal);

    // Cerrar con tecla ESC
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            if (imageFullscreenModal.classList.contains('active')) {
                closeFullscreenImage();
            } else if (modal.classList.contains('active')) {
                closeModal();
            }
        }
    });

    // Navegaci칩n con teclado
    document.addEventListener('keydown', (e) => {
        // Navegaci칩n en imagen completa
        if (imageFullscreenModal.classList.contains('active')) {
            if (e.key === 'ArrowLeft') {
                fullscreenPrev?.click();
            } else if (e.key === 'ArrowRight') {
                fullscreenNext?.click();
            }
        }
        // Navegaci칩n en modal principal
        else if (modal.classList.contains('active')) {
            if (e.key === 'ArrowLeft') {
                document.getElementById('galleryPrev')?.click();
            } else if (e.key === 'ArrowRight') {
                document.getElementById('galleryNext')?.click();
            }
        }
    });

    // Funci칩n para compartir por WhatsApp
function shareViaWhatsApp() {
    if (!currentProperty) return;
    
    const propertyUrl = generatePropertyUrl(currentProperty.id);
    
    // Mensaje personalizado para WhatsApp
    const message = `游 *${currentProperty.title}*\n\n游눯 ${currentProperty.price}\n\n游늸 ${currentProperty.location.address}\n\n${currentProperty.description.substring(0, 150)}...\n\n游댕 Ver m치s detalles: ${propertyUrl}`;
    
    // Codificar el mensaje para URL
    const encodedMessage = encodeURIComponent(message);
    
    // URL de WhatsApp (funciona en m칩vil y desktop)
    const whatsappUrl = `https://api.whatsapp.com/send?text=${encodedMessage}`;
    
    // Abrir WhatsApp en una nueva ventana/pesta침a
    window.open(whatsappUrl, '_blank');
}

// Funci칩n para compartir propiedad (general - mantiene la funcionalidad original)
async function shareProperty() {
    if (!currentProperty) return;
    
    const propertyUrl = generatePropertyUrl(currentProperty.id);
    const shareData = {
        title: currentProperty.title,
        text: `${currentProperty.title} - ${currentProperty.price}\n${currentProperty.description.substring(0, 100)}...`,
        url: propertyUrl
    };
    
    const btnShare = document.getElementById('btnShare');
    
    // Verificar si el navegador soporta Web Share API
    if (navigator.share) {
        try {
            await navigator.share(shareData);
            console.log('Contenido compartido exitosamente');
        } catch (err) {
            if (err.name !== 'AbortError') {
                console.log('Error al compartir:', err);
                copyToClipboard(propertyUrl, btnShare);
            }
        }
    } else {
        copyToClipboard(propertyUrl, btnShare);
    }
}
</script>